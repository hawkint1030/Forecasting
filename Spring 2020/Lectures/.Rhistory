dQ <- seasonaldummy(qcement) # Quickly create the 3 seasonal dummies
lm_cement <- lm(qcement~t+dQ)
fit_cement <- lm_cement$fitted
r_cement <- summary(lm_cement)$r.squared
cc2 <- lm_cement$coef
nx <- c("t","Q1","Q2","Q3")
ts.plot(qcement,fit_cement,col=c(4,6),main = "Total quarterly production of Portland cement in Australia",lwd=c(1.5,2))
legend("topleft", legend=c("Data","Predicted"),col = c(4,6),lwd=c(1.5,2),bty = "n")
text(1980,0.7, paste("y=", paste(round(cc2[1],2), paste(round(cc2[-1],2), nx, sep=" * ", collapse=" + "), sep=" + "), "+ e"))
#grid()
t <- 1: length(qcement)
dQ <- seasonaldummy(qcement) # Quickly create the 3 seasonal dummies
lm_cement <- lm(qcement~t+dQ)
fit_cement <- lm_cement$fitted
r_cement <- summary(lm_cement)$r.squared
cc2 <- lm_cement$coef
nx <- c("t","Q1","Q2","Q3")
ts.plot(qcement,fit_cement,col=c(4,6),main = "Total quarterly production of Portland cement in Australia",lwd=c(1.5,2))
legend("topleft", legend=c("Data","Predicted"),col = c(4,6),lwd=c(1.5,2),bty = "n")
text(2000,0.7, paste("y=", paste(round(cc2[1],2), paste(round(cc2[-1],2), nx, sep=" * ", collapse=" + "), sep=" + "), "+ e"))
#grid()
lm_cement$coef
t <- 1: length(qcement)
dQ <- seasonaldummy(qcement) # Quickly create the 3 seasonal dummies
lm_cement <- lm(qcement~t+dQ)
fit_cement <- lm_cement$fitted
r_cement <- summary(lm_cement)$r.squared
cc2 <- lm_cement$coef
nx <- c("t","Q1","Q2","Q3")
ts.plot(qcement,fit_cement,col=c(4,6),main = "Total quarterly production of Portland cement in Australia",lwd=c(1.5,2))
legend("topleft", legend=c("Data","Predicted"),col = c(4,6),lwd=c(1.5,2),bty = "n")
text(2000,0.7, paste("y=", paste(round(cc2[1],2), paste(round(cc2[-1],2), nx, sep=" * "))
#grid()
t <- 1: length(qcement)
dQ <- seasonaldummy(qcement) # Quickly create the 3 seasonal dummies
lm_cement <- lm(qcement~t+dQ)
fit_cement <- lm_cement$fitted
r_cement <- summary(lm_cement)$r.squared
cc2 <- lm_cement$coef
nx <- c("t","Q1","Q2","Q3")
ts.plot(qcement,fit_cement,col=c(4,6),main = "Total quarterly production of Portland cement in Australia",lwd=c(1.5,2))
legend("topleft", legend=c("Data","Predicted"),col = c(4,6),lwd=c(1.5,2),bty = "n")
text(2000,0.7, paste("y=", paste(round(cc2[1],2), paste(round(cc2[-1],2), nx, sep=" * "))))
#grid()
t <- 1: length(qcement)
dQ <- seasonaldummy(qcement) # Quickly create the 3 seasonal dummies
lm_cement <- lm(qcement~t+dQ)
fit_cement <- lm_cement$fitted
r_cement <- summary(lm_cement)$r.squared
cc2 <- lm_cement$coef
nx <- c("t","Q1","Q2","Q3")
ts.plot(qcement,fit_cement,col=c(4,6),main = "Total quarterly production of Portland cement in Australia",lwd=c(1.5,2))
legend("topleft", legend=c("Data","Predicted"),col = c(4,6),lwd=c(1.5,2),bty = "n")
text(2000,0.7, paste("y=", paste(round(cc2[1],2), paste(round(cc2[-1],2), nx, sep=" * "))))
#grid()
t <- 1: length(qcement)
dQ <- seasonaldummy(qcement) # Quickly create the 3 seasonal dummies
lm_cement <- lm(qcement~t+dQ)
fit_cement <- lm_cement$fitted
r_cement <- summary(lm_cement)$r.squared
cc2 <- lm_cement$coef
nx <- c("t","Q1","Q2","Q3")
ts.plot(qcement,fit_cement,col=c(4,6),main = "Total quarterly production of Portland cement in Australia",lwd=c(1.5,2))
legend("topleft", legend=c("Data","Predicted"),col = c(4,6),lwd=c(1.5,2),bty = "n")
text(2000,0.7, paste("y=", paste(round(cc2[1],2), paste(round(cc2[-1],2), nx, sep=" * ",collapse = "+"))))
#grid()
t <- 1: length(qcement)
dQ <- seasonaldummy(qcement) # Quickly create the 3 seasonal dummies
lm_cement <- lm(qcement~t+dQ)
fit_cement <- lm_cement$fitted
r_cement <- summary(lm_cement)$r.squared
cc2 <- lm_cement$coef
nx <- c("t","Q1","Q2","Q3")
ts.plot(qcement,fit_cement,col=c(4,6),main = "Total quarterly production of Portland cement in Australia",lwd=c(1.5,2))
legend("topleft", legend=c("Data","Predicted"),col = c(4,6),lwd=c(1.5,2),bty = "n")
text(2000,0.7, paste("y=", paste(round(cc2[1],2), paste(round(cc2[-1],2), nx, sep=" * ",collapse = "+"),collapse = "+")))
#grid()
t <- 1: length(qcement)
dQ <- seasonaldummy(qcement) # Quickly create the 3 seasonal dummies
lm_cement <- lm(qcement~t+dQ)
fit_cement <- lm_cement$fitted
r_cement <- summary(lm_cement)$r.squared
cc2 <- lm_cement$coef
nx <- c("t","Q1","Q2","Q3")
ts.plot(qcement,fit_cement,col=c(4,6),main = "Total quarterly production of Portland cement in Australia",lwd=c(1.5,2))
legend("topleft", legend=c("Data","Predicted"),col = c(4,6),lwd=c(1.5,2),bty = "n")
text(2000,0.7, paste("y=", paste(round(cc2[1],2), paste(round(cc2[-1],2), nx, sep=" * ",collapse = "+")),collapse = "+"))
#grid()
t <- 1: length(qcement)
dQ <- seasonaldummy(qcement) # Quickly create the 3 seasonal dummies
lm_cement <- lm(qcement~t+dQ)
fit_cement <- lm_cement$fitted
r_cement <- summary(lm_cement)$r.squared
cc2 <- lm_cement$coef
nx <- c("t","Q1","Q2","Q3")
ts.plot(qcement,fit_cement,col=c(4,6),main = "Total quarterly production of Portland cement in Australia",lwd=c(1.5,2))
legend("topleft", legend=c("Data","Predicted"),col = c(4,6),lwd=c(1.5,2),bty = "n")
text(2000,0.7, paste("y=", paste(round(cc2[1],2), paste(round(cc2[-1],2), nx, sep=" * ", collapse=" + "), sep=" + ")))
#grid()
t <- 1: length(qcement)
dQ <- seasonaldummy(qcement) # Quickly create the 3 seasonal dummies
lm_cement <- lm(qcement~t+dQ)
fit_cement <- lm_cement$fitted
r_cement <- summary(lm_cement)$r.squared
cc2 <- lm_cement$coef
nx <- c("t","Q1","Q2","Q3")
ts.plot(qcement,fit_cement,col=c(4,6),main = "Total quarterly production of Portland cement in Australia",lwd=c(1.5,2))
legend("topleft", legend=c("Data","Predicted"),col = c(4,6),lwd=c(1.5,2),bty = "n")
text(1980,0.7, paste("y=", paste(round(cc2[1],2), paste(round(cc2[-1],2), nx, sep=" * ", collapse=" + "), sep=" + ")))
#grid()
t <- 1: length(qcement)
dQ <- seasonaldummy(qcement) # Quickly create the 3 seasonal dummies
lm_cement <- lm(qcement~t+dQ)
fit_cement <- lm_cement$fitted
r_cement <- summary(lm_cement)$r.squared
cc2 <- lm_cement$coef
nx <- c("t","Q1","Q2","Q3")
ts.plot(qcement,fit_cement,col=c(4,6),main = "Total quarterly production of Portland cement in Australia",lwd=c(1.5,2))
legend("topleft", legend=c("Data","Predicted"),col = c(4,6),lwd=c(1.5,2),bty = "n")
text(1990,0.7, paste("y=", paste(round(cc2[1],2), paste(round(cc2[-1],2), nx, sep=" * ", collapse=" + "), sep=" + ")))
#grid()
round(lm_cement$coef,3)
t <- 1: length(qcement)
dQ <- seasonaldummy(qcement) # Quickly create the 3 seasonal dummies
lm_cement <- lm(qcement~t+dQ)
fit_cement <- lm_cement$fitted
r_cement <- summary(lm_cement)$r.squared
cc2 <- lm_cement$coef
nx <- c("t","Q1","Q2","Q3")
ts.plot(qcement,fit_cement,col=c(4,6),main = "Total quarterly production of Portland cement in Australia",lwd=c(1.5,2))
legend("topleft", legend=c("Data","Predicted"),col = c(4,6),lwd=c(1.5,2),bty = "n")
text(1990,0.7, TeX("y_t = 0.634 + 0.008\cdot t -0.192 Q_1 -0.025 Q_2+0.028Q_3"))
t <- 1: length(qcement)
dQ <- seasonaldummy(qcement) # Quickly create the 3 seasonal dummies
lm_cement <- lm(qcement~t+dQ)
fit_cement <- lm_cement$fitted
r_cement <- summary(lm_cement)$r.squared
cc2 <- lm_cement$coef
nx <- c("t","Q1","Q2","Q3")
ts.plot(qcement,fit_cement,col=c(4,6),main = "Total quarterly production of Portland cement in Australia",lwd=c(1.5,2))
legend("topleft", legend=c("Data","Predicted"),col = c(4,6),lwd=c(1.5,2),bty = "n")
text(1990,0.7, TeX("y_t = 0.634 + 0.008 t -0.192 Q_1 -0.025 Q_2+0.028 Q_3"))
#grid()
t <- 1: length(qcement)
dQ <- seasonaldummy(qcement) # Quickly create the 3 seasonal dummies
lm_cement <- lm(qcement~t+dQ)
fit_cement <- lm_cement$fitted
r_cement <- summary(lm_cement)$r.squared
cc2 <- lm_cement$coef
nx <- c("t","Q1","Q2","Q3")
ts.plot(qcement,fit_cement,col=c(4,6),main = "Total quarterly production of Portland cement in Australia",lwd=c(1.5,2))
legend("topleft", legend=c("Data","Predicted"),col = c(4,6),lwd=c(1.5,2),bty = "n")
text(1990,0.7, TeX("y_t = 0.634 + 0.008\\cdot t -0.192Q_1 -0.025Q_2+0.028Q_3"))
#grid()
text(1990,0.5, `r r_cement`)
text(1990,0.5, r_cement)
t <- 1: length(qcement)
dQ <- seasonaldummy(qcement) # Quickly create the 3 seasonal dummies
lm_cement <- lm(qcement~t+dQ)
fit_cement <- lm_cement$fitted
r_cement <- summary(lm_cement)$r.squared
cc2 <- lm_cement$coef
nx <- c("t","Q1","Q2","Q3")
ts.plot(qcement,fit_cement,col=c(4,6),main = "Total quarterly production of Portland cement in Australia",lwd=c(1.5,2))
legend("topleft", legend=c("Data","Predicted"),col = c(4,6),lwd=c(1.5,2),bty = "n")
text(1990,0.7, TeX("y_t = 0.634 + 0.008t - 0.192Q_1 - 0.025Q_2 + 0.028Q_3"))
text(1990,0.5, r_cement)
#grid()
text(1990,0.5, round(r_cement,3))
t <- 1: length(qcement)
dQ <- seasonaldummy(qcement) # Quickly create the 3 seasonal dummies
lm_cement <- lm(qcement~t+dQ)
fit_cement <- lm_cement$fitted
r_cement <- summary(lm_cement)$r.squared
cc2 <- lm_cement$coef
nx <- c("t","Q1","Q2","Q3")
ts.plot(qcement,fit_cement,col=c(4,6),main = "Total quarterly production of Portland cement in Australia",lwd=c(1.5,2))
legend("topleft", legend=c("Data","Predicted"),col = c(4,6),lwd=c(1.5,2),bty = "n")
text(1990,0.7, TeX("y_t = 0.634 + 0.008t - 0.192Q_1 - 0.025Q_2 + 0.028Q_3"))
text(1990,0.5, round(r_cement,3))
#grid()
t <- 1: length(qcement)
dQ <- seasonaldummy(qcement) # Quickly create the 3 seasonal dummies
lm_cement <- lm(qcement~t+dQ)
fit_cement <- lm_cement$fitted
r_cement <- summary(lm_cement)$r.squared
cc2 <- lm_cement$coef
nx <- c("t","Q1","Q2","Q3")
ts.plot(qcement,fit_cement,col=c(4,6),main = "Total quarterly production of Portland cement in Australia",lwd=c(1.5,2))
legend("topleft", legend=c("Data","Predicted"),col = c(4,6),lwd=c(1.5,2),bty = "n")
text(1990,0.7, TeX("y_t = 0.634 + 0.008t - 0.192Q_1 - 0.025Q_2 + 0.028Q_3"))
text(1990,0.5, paste(TeX('$\\alpha^\\beta$') = round(r_cement,4)))
t <- 1: length(qcement)
dQ <- seasonaldummy(qcement) # Quickly create the 3 seasonal dummies
lm_cement <- lm(qcement~t+dQ)
fit_cement <- lm_cement$fitted
r_cement <- summary(lm_cement)$r.squared
cc2 <- lm_cement$coef
nx <- c("t","Q1","Q2","Q3")
ts.plot(qcement,fit_cement,col=c(4,6),main = "Total quarterly production of Portland cement in Australia",lwd=c(1.5,2))
legend("topleft", legend=c("Data","Predicted"),col = c(4,6),lwd=c(1.5,2),bty = "n")
text(1990,0.7, TeX("y_t = 0.634 + 0.008t - 0.192Q_1 - 0.025Q_2 + 0.028Q_3"))
text(1990,0.5, TeX('$\\alpha^\\beta$'))
#grid()
t <- 1: length(qcement)
dQ <- seasonaldummy(qcement) # Quickly create the 3 seasonal dummies
lm_cement <- lm(qcement~t+dQ)
fit_cement <- lm_cement$fitted
r_cement <- summary(lm_cement)$r.squared
cc2 <- lm_cement$coef
nx <- c("t","Q1","Q2","Q3")
ts.plot(qcement,fit_cement,col=c(4,6),main = "Total quarterly production of Portland cement in Australia",lwd=c(1.5,2))
legend("topleft", legend=c("Data","Predicted"),col = c(4,6),lwd=c(1.5,2),bty = "n")
text(1990,0.7, TeX("y_t = 0.634 + 0.008t - 0.192Q_1 - 0.025Q_2 + 0.028Q_3"))
text(1990,0.5, TeX('R^2'))
#grid()
t <- 1: length(qcement)
dQ <- seasonaldummy(qcement) # Quickly create the 3 seasonal dummies
lm_cement <- lm(qcement~t+dQ)
fit_cement <- lm_cement$fitted
r_cement <- summary(lm_cement)$r.squared
cc2 <- lm_cement$coef
nx <- c("t","Q1","Q2","Q3")
ts.plot(qcement,fit_cement,col=c(4,6),main = "Total quarterly production of Portland cement in Australia",lwd=c(1.5,2))
legend("topleft", legend=c("Data","Predicted"),col = c(4,6),lwd=c(1.5,2),bty = "n")
text(1990,0.7, TeX("y_t = 0.634 + 0.008t - 0.192Q_1 - 0.025Q_2 + 0.028Q_3"))
text(1990,0.5, TeX('$R^2 = $'  = round(r_cement,4)))
t <- 1: length(qcement)
dQ <- seasonaldummy(qcement) # Quickly create the 3 seasonal dummies
lm_cement <- lm(qcement~t+dQ)
fit_cement <- lm_cement$fitted
r_cement <- summary(lm_cement)$r.squared
cc2 <- lm_cement$coef
nx <- c("t","Q1","Q2","Q3")
ts.plot(qcement,fit_cement,col=c(4,6),main = "Total quarterly production of Portland cement in Australia",lwd=c(1.5,2))
legend("topleft", legend=c("Data","Predicted"),col = c(4,6),lwd=c(1.5,2),bty = "n")
text(1990,0.7, TeX("y_t = 0.634 + 0.008t - 0.192Q_1 - 0.025Q_2 + 0.028Q_3"))
text(1990,0.5, TeX('$R^2 = $  = round(r_cement,4)'))
#grid()
r_cement <- summary(lm_cement)$r.squared
r_cement
t <- 1: length(qcement)
dQ <- seasonaldummy(qcement) # Quickly create the 3 seasonal dummies
lm_cement <- lm(qcement~t+dQ)
fit_cement <- lm_cement$fitted
r_cement <- summary(lm_cement)$r.squared
cc2 <- lm_cement$coef
nx <- c("t","Q1","Q2","Q3")
ts.plot(qcement,fit_cement,col=c(4,6),main = "Total quarterly production of Portland cement in Australia",lwd=c(1.5,2))
legend("topleft", legend=c("Data","Predicted"),col = c(4,6),lwd=c(1.5,2),bty = "n")
text(1990,0.7, TeX("y_t = 0.634 + 0.008t - 0.192Q_1 - 0.025Q_2 + 0.028Q_3"))
text(1990,0.5, TeX('$R^2 = 0.940$'))
#grid()
t <- 1: length(qcement)
dQ <- seasonaldummy(qcement) # Quickly create the 3 seasonal dummies
lm_cement <- lm(qcement~t+dQ)
fit_cement <- lm_cement$fitted
r_cement <- summary(lm_cement)$r.squared
cc2 <- lm_cement$coef
nx <- c("t","Q1","Q2","Q3")
ts.plot(qcement,fit_cement,col=c(4,6),main = "Total quarterly production of Portland cement in Australia",lwd=c(1.5,2))
legend("topleft", legend=c("Data","Predicted"),col = c(4,6),lwd=c(1.5,2),bty = "n")
text(1993,0.7, TeX("y_t = 0.634 + 0.008t - 0.192Q_1 - 0.025Q_2 + 0.028Q_3"))
text(1993,0.5, TeX('$R^2 = 0.940$'))
#grid()
t <- 1: length(qcement)
dQ <- seasonaldummy(qcement) # Quickly create the 3 seasonal dummies
lm_cement <- lm(qcement~t+dQ)
fit_cement <- lm_cement$fitted
r_cement <- summary(lm_cement)$r.squared
cc2 <- lm_cement$coef
nx <- c("t","Q1","Q2","Q3")
ts.plot(qcement,fit_cement,col=c(4,6),main = "Total quarterly production of Portland cement in Australia",lwd=c(1.5,2))
legend("topleft", legend=c("Data","Predicted"),col = c(4,6),lwd=c(1.5,2),bty = "n")
text(1993,0.7, TeX("y_t = 0.634 + 0.008t - 0.192Q_1 - 0.025Q_2 + 0.028Q_3"))
text(1993,0.5, TeX('$R^2 = 0.940$'))
tsplot(fit_cement,col=6,main = "Predicted Quarterly production of Portland cement in Australia",lwd=2)
#legend("topleft", legend=c("Data","Predicted"),col = c(4,6),lwd=c(1.5,2),bty = "n")
text(1993,0.7, TeX("y_t = 0.634 + 0.008t - 0.192Q_1 - 0.025Q_2 + 0.028Q_3"))
text(1993,0.5, TeX('$R^2 = 0.940$'))
#grid()
t <- 1: length(qcement)
dQ <- seasonaldummy(qcement) # Quickly create the 3 seasonal dummies
lm_cement <- lm(qcement~t+dQ)
fit_cement <- lm_cement$fitted
r_cement <- summary(lm_cement)$r.squared
cc2 <- lm_cement$coef
nx <- c("t","Q1","Q2","Q3")
ts.plot(qcement,fit_cement,col=c(4,6),main = "Total quarterly production of Portland cement in Australia",lwd=c(1.5,2))
legend("topleft", legend=c("Data","Predicted"),col = c(4,6),lwd=c(1.5,2),bty = "n")
text(1993,0.7, TeX("y_t = 0.634 + 0.008t - 0.192Q_1 - 0.025Q_2 + 0.028Q_3"))
text(1993,0.5, TeX('$R^2 = 0.940$'))
tsplot(fit_cement,col=6,main = "Predicted Quarterly production of Portland cement in Australia",lwd=2,type = "o")
#legend("topleft", legend=c("Data","Predicted"),col = c(4,6),lwd=c(1.5,2),bty = "n")
text(1993,0.7, TeX("y_t = 0.634 + 0.008t - 0.192Q_1 - 0.025Q_2 + 0.028Q_3"))
text(1993,0.5, TeX('$R^2 = 0.940$'))
#grid()
t <- 1: length(qcement)
dQ <- seasonaldummy(qcement) # Quickly create the 3 seasonal dummies
lm_cement <- lm(qcement~t+dQ)
fit_cement <- lm_cement$fitted
r_cement <- summary(lm_cement)$r.squared
cc2 <- lm_cement$coef
nx <- c("t","Q1","Q2","Q3")
par(mfrow=c(2,1))
ts.plot(qcement,fit_cement,col=c(4,6),main = "Total quarterly production of Portland cement in Australia",lwd=c(1.5,2))
legend("topleft", legend=c("Data","Predicted"),col = c(4,6),lwd=c(1.5,2),bty = "n")
text(1993,0.7, TeX("y_t = 0.634 + 0.008t - 0.192Q_1 - 0.025Q_2 + 0.028Q_3"))
text(1993,0.5, TeX('$R^2 = 0.940$'))
tsplot(fit_cement,col=6,main = "Predicted Quarterly production of Portland cement in Australia",lwd=2,type = "o")
#legend("topleft", legend=c("Data","Predicted"),col = c(4,6),lwd=c(1.5,2),bty = "n")
text(1993,0.7, TeX("y_t = 0.634 + 0.008t - 0.192Q_1 - 0.025Q_2 + 0.028Q_3"))
text(1993,0.5, TeX('$R^2 = 0.940$'))
#grid()
t <- 1: length(qcement)
dQ <- seasonaldummy(qcement) # Quickly create the 3 seasonal dummies
lm_cement <- lm(qcement~t+dQ)
fit_cement <- lm_cement$fitted
r_cement <- summary(lm_cement)$r.squared
cc2 <- lm_cement$coef
nx <- c("t","Q1","Q2","Q3")
par(mfrow=c(2,1))
ts.plot(qcement,fit_cement,col=c(4,6),main = "Total quarterly production of Portland cement in Australia",lwd=c(1.5,2))
legend("topleft", legend=c("Data","Predicted"),col = c(4,6),lwd=c(1.5,2),bty = "n")
text(1993,0.7, TeX("y_t = 0.634 + 0.008t - 0.192Q_1 - 0.025Q_2 + 0.028Q_3"))
text(1993,0.5, TeX('$R^2 = 0.940$'))
tsplot(fit_cement,col=6,main = "Predicted Quarterly production of Portland cement in Australia",lwd=2,type = "o")
#legend("topleft", legend=c("Data","Predicted"),col = c(4,6),lwd=c(1.5,2),bty = "n")
text(1993,0.7, TeX("y_t = 0.634 + 0.008t - 0.192Q_1 - 0.025Q_2 + 0.028Q_3"))
text(1993,0.5, TeX('$R^2 = 0.940$'))
#grid()
t <- 1: length(qcement)
dQ <- seasonaldummy(qcement) # Quickly create the 3 seasonal dummies
lm_cement <- lm(qcement~t+dQ)
fit_cement <- lm_cement$fitted
r_cement <- summary(lm_cement)$r.squared
cc2 <- lm_cement$coef
nx <- c("t","Q1","Q2","Q3")
par(mfrow=c(2,1))
ts.plot(qcement,fit_cement,col=c(4,6),main = "Total Quarterly production of Portland cement in Australia",lwd=c(1.5,2),ylab="",xlab="")
legend("topleft", legend=c("Data","Predicted"),col = c(4,6),lwd=c(1.5,2),bty = "n")
text(1993,0.7, TeX("y_t = 0.634 + 0.008t - 0.192Q_1 - 0.025Q_2 + 0.028Q_3"))
text(1993,0.5, TeX('$R^2 = 0.940$'))
plot(fit_cement,col=6,main = "Predicted Quarterly production of Portland cement in Australia",lwd=2,type = "o",ylab="",xlab="")
#legend("topleft", legend=c("Data","Predicted"),col = c(4,6),lwd=c(1.5,2),bty = "n")
text(1993,0.7, TeX("y_t = 0.634 + 0.008t - 0.192Q_1 - 0.025Q_2 + 0.028Q_3"))
text(1993,0.5, TeX('$R^2 = 0.940$'))
#grid()
t <- 1: length(qcement)
dQ <- seasonaldummy(qcement) # Quickly create the 3 seasonal dummies
lm_cement <- lm(qcement~t+dQ)
fit_cement <- lm_cement$fitted
r_cement <- summary(lm_cement)$r.squared
cc2 <- lm_cement$coef
nx <- c("t","Q1","Q2","Q3")
ts.plot(qcement,fit_cement,col=c(4,6),main = "Total Quarterly production of Portland cement in Australia",lwd=c(1.5,2),ylab="",xlab="")
legend("topleft", legend=c("Data","Predicted"),col = c(4,6),lwd=c(1.5,2),bty = "n")
text(1993,0.7, TeX("y_t = 0.634 + 0.008t - 0.192Q_1 - 0.025Q_2 + 0.028Q_3"))
text(1993,0.5, TeX('$R^2 = 0.940$'))
include_graphics("EMA.png")
llibrary(fpp2)
library(fpp2)
ets(h02)
ets(h02) %>% forecast() %>% autoplot()
ets(h02) %>% forecast()
str(ets(h02) %>% forecast())
ets(h02) %>% forecast() %>% autoplot(.,col="red")
ets(h02) %>% forecast() %>% autoplot(.,ts.col="red")
ets(h02) %>% forecast() %>% autoplot()
hep(fpp2)
help(fpp2)
autoplot(h02)
ets(h02) %>% forecast() %>% autoplot()
forecast(h02)
forecast(h02)  %>% ggplot2()
forecast(h02)  %>% autoplot
autoplot(h02)
ets(h02) %>% forecast() %>% autoplot()
cat("\014")
rm(list=ls())
library(fpp2)
autoplot(h02)
ets(h02) %>% forecast() %>% autoplot()
autoplot(marathon) + xlab("Year") + ylab("Winning Now!")
library(fpp2)
library(latex2exp)
autoplot(marathon) + xlab("Year") + ylab(TeX("Winning now \\beta"))
autoplot(marathon) + xlab("Year") + ylab(TeX("Winning now \beta"))
autoplot(marathon) + xlab("Year") + ylab(TeX("Winning now $\beta%"))
autoplot(marathon) + xlab("Year") + ylab(TeX("Winning now $\beta$"))
autoplot(marathon) + xlab("Year") + ylab(TeX("Winning now $beta$"))
autoplot(marathon) + xlab("Year") + ylab(TeX("Winning now $\\beta$"))
autoplot(marathon) + xlab("Year") + ylab(TeX("Winning now $\\beta$")) + main("FFFFFF")
autoplot(marathon) + xlab("Year") + ylab(TeX("Winning now $\\beta$")) + title("FFFFFF")
autoplot(marathon,main = "hahahah") + xlab("Year") + ylab(TeX("Winning now $\\beta$"))
autoplot(marathon,main = "hahahah", lwd=2) + xlab("Year") + ylab(TeX("Winning now $\\beta$"))
autoplot(marathon,main = "hahahah", col="red") + xlab("Year") + ylab(TeX("Winning now $\\beta$"))
fits <- tslm(marathon~trend)
fits <- tslm(marathon~trend) %>% summary
(fits <- tslm(marathon~trend)) %>% summary
fits
length(marathon)
dim(marathon)
str(marathon)
tt <- 1:120
(fits <- tslm(marathon~tt)) %>% summary
autoplot(marathon,main = "hahahah", col="red") + xlab("Year") + ylab(TeX("Winning now $\\beta$")) + geom_abline(fits$coefficients[1])
autoplot(marathon,main = "hahahah", col="red") + xlab("Year") + ylab(TeX("Winning now $\\beta$")) +
geom_line(fits$coefficients[1])
autoplot(marathon,main = "hahahah", col="red") + xlab("Year") + ylab(TeX("Winning now $\\beta$")) +
autolayer(trendcycle(fits))
autoplot(marathon,main = "hahahah", col="red") + xlab("Year") + ylab(TeX("Winning now $\\beta$")) +
autolayer(trendcycle(fit))
autoplot(marathon,main = "hahahah", col="red",series = "Data") + xlab("Year") + ylab(TeX("Winning now $\\beta$"))
autolayer(trendcycle(fits))
??trendcycle
autoplot(marathon,main = "hahahah", col="red",series = "Data") + xlab("Year") + ylab(TeX("Winning now $\\beta$")) +
geom_line(loess(fits))
autoplot(marathon,main = "hahahah", col="red",series = "Data") + xlab("Year") + ylab(TeX("Winning now $\\beta$")) +
autoplot(loess(fits))
seq_along(120)
seq_along(marathon)
h02 %>% ets %>% forecast() %>% autoplot()
usmelec %>% autoplot()
usmelec %>% log() %>% autoplot()
usmelec %>% log() %>% diff(lag=12) %>% autoplot()
usmelec %>% log() %>% diff(lag=12) %>% autoplot() %>% ggAcf()
usmelec %>% log() %>% diff(lag=12) %>% ggAcf()
usmelec %>% log() %>% diff(lag=12) %>% diff(lag=1) %>% ggAcf()
usmelec %>% log() %>% diff(lag=24) %>% diff(lag=1) %>% ggAcf()
usmelec %>% log() %>% diff(lag=12) %>% diff(lag=2) %>% ggAcf()
usmelec %>% log() %>% diff(lag=12) %>% diff(lag=1) %>% ggAcf()
setwd("C:/Users/stewartls/Dropbox/Teaching/AppliedForecasting/Spring 2020/Lectures/basictemplate/basictemplate/inst/rmarkdown/templates/report/skeleton")
setwd("C:/Users/stewartls/Dropbox/Teaching/AppliedForecasting/Spring 2020/Lectures")
devtools::create("basictemplate")
include_graphics("images/SMA2.png")
include_graphics("../images/SMA2.png")
if(!require(fpp))install.packages("fpp"); require(fpp)
if(!require(astsa))install.packages("astsa"); require(astsa)
if(!require(quantmod))install.packages("quantmod"); require(quantmod)
if(!require(latex2exp))install.packages("latex2exp"); require(latex2exp)
if(!require(ggplot2))install.packages("ggplot2"); require(ggplot2)
library(knitr)
start_date <- as.Date("2017-01-02")
end_date <- as.Date("2019-10-01")
getSymbols("DJI", src = "yahoo", from = start_date, to = end_date)
getSymbols("CPIAUCSL", src = "FRED", from = start_date, to = end_date)
par(mfrow=c(2,2),bg="white")
tsplot(oil,main= "Crude oil, WTI spot price FOB" , ylab="($ per barrel)",xlab="",lwd=2,col="green4")
tsplot(soi,main= "Southern Oscillation Index (SOI)" , ylab="",xlab="",lwd=2)
text(1970, .91, "COOL", col="cyan4",font = 2)
text(1970,-.91, "WARM", col="darkmagenta",font=2)
tsplot(as.zoo(DJI$DJI.Close),main = "Dow Jones Index",ylab= "Closing Price",xlab = "",lwd = 2, col="blue")
tsplot(as.zoo(CPIAUCSL),main = "US Consumer Price Index",ylab= "Index",xlab = "",lwd = 2, col="red")
#dev.off()
par(mfrow=c(1,3),bg="white")
tsplot(as.zoo(CPIAUCSL),main = "US Consumer Price Index",ylab= "Index",xlab = "",lwd = 2, col="black")
tsplot(jj,main = "Johnson & Johnson Earnings",ylab= "Earnings per share",xlab = "",lwd = 2, col="green4")
tsplot(austa,main = "Total International Visitors to Australia",ylab= "",xlab = "",lwd = 2, col="blue")
#tsplot(a10,main = "Antidiabetic drug sales",ylab= "$ million" ,xlab = "",lwd = 2, col="red4")
imps <- ts(exp((0:30/4)^1/2),end= c(2018,1),frequency = 1)
tsplot(imps,type = "o",main="Volume of Imports",ylab="Imports(Millions)",xlab="",lwd=2)
tsplot(log(imps),type = "o",main="Logged Imports",ylab="log(Imports)",xlab="",lwd=2)
# par(mfrow=c(1,3),bg="white")
tsplot(a10,main = "Monthly anti-diabetic drug sales",ylab= "$ million" ,xlab = "",lwd = 2, col="red4")
# par(mfrow=c(1,3),bg="white")
#par(mfrow=2:1)
t <- 1: length(a10)
fit <- lm(a10~t)
r.2 <- round(summary(fit)$r.squared,3)
ts.plot(a10,fit$fitted,main = "Monthly anti-diabetic drug sales",ylab= "$ million" ,xlab = "",lwd = 2, col=c("red4","blue"))
text(1993,27, TeX("y = 1.131 + 0.093t"),font=2)
text(1992.5,23, TeX("$R^2$ = 0.855"),font=2)
# par(mfrow=c(1,3),bg="white")
#par(mfrow=2:1)
fite <- lm(log(a10)~t)
r.2e <- round(summary(fite)$r.squared,3)
ts.plot(a10,exp(fite$fitted),main = "Monthly anti-diabetic drug sales",ylab= "$ million" ,xlab = "",lwd = 2, col=c("red4","blue"))
text(1993,27, TeX("$\\log$ (y) = 1.258 + 0.093t"),font=2)
text(1992.5,23, TeX("$R^2$ = 0.927"),font=2)
# par(mfrow=c(1,3),bg="white")
#par(mfrow=2:1)
ts <- t^2
fitq <- lm(a10~t+ts)
r.2q <- round(summary(fitq)$r.squared,3)
ts.plot(a10,fitq$fitted,main = "Monthly anti-diabetic drug sales",ylab= "$ million" ,xlab = "",lwd = 2, col=c("red4","blue"))
text(1994.25,27, TeX("y = 3.968 + 0.011 $\\log$(t) + 0.0004 $\\log (t^2)$"),font=2)
text(1992.5,23, TeX("$R^2$ = 0.899"),font=2)
data2 <- data <- NA
for (i in 4:length(elecsales)){ # Calculating 4 point MA
data[i] <- sum(elecsales[i:(i-3)])/4
}
for (i in 8:length(elecsales)){ # Calculating 8 point MA
data2[i] <- sum(elecsales[i:(i-7)])/8
}
data.ts <- ts(data,start=c(1989,1),frequency=1)
data2.ts <- ts(data2,start=c(1989,1),frequency=1)
par(mfrow=c(1,2))
ts.plot(elecsales,data.ts,main="Annual Electricity Sales: South Australia", lwd=2,col=c(4,3),type="o",ylab="GWh",xlab="")
mtext("4-point MA",side=3,col="red",cex=0.9)
legend("topleft", legend=c("Data","4-point MA"),col = c(4,3),lty=1:2,pch=c(1,1))
grid()
ts.plot(elecsales,data2.ts,main="Annual Electricity Sales: South Australia", lwd=2,col=c(4,3),type="o",ylab="GWh",xlab="")
mtext("8-point MA",side=3,col="red",cex=0.9)
legend("topleft", legend=c("Data","8-point MA"),col = c(4,3),lty=1:2,pch=c(1,1))
grid()
include_graphics("../images/SMA2.png")
include_graphics("../images/MA.png")
include_graphics("../images/SMA2.png")
include_graphics("../images/MA.png")
include_graphics("images/SMA2.png")
include_graphics("../images/MA.png")
